[
  {
    "key": "admin",
    "name": "Institution <%= institution_name %> Admin",
    "policy": {
      "statement": [
        {
          "resource": "institution/<%= institution_id %>",
          "action": [
            "institution:read",
            "institution:update",
            "institution:registerDevice",
            "institution:createPatient",
            "institution:createSite",
            "institution:createRole",
            "institution:readUsers"
          ],
          "delegable": true
        },
        {
          "resource": "testResult?institution=<%= institution_id %>",
          "action": "testResult:medicalDashboard",
          "delegable": true
        },
        {
          "resource": "patient?institution=<%= institution_id %>",
          "action": "*",
          "delegable": true
        },
        {
          "resource": "site?institution=<%= institution_id %>",
          "action": "*",
          "delegable": true
        },
        {
          "resource": "device?institution=<%= institution_id %>",
          "action": "*",
          "delegable": true
        },
        {
          "resource": "testResult?institution=<%= institution_id %>",
          "action": "*",
          "delegable": true
        },
        {
          "resource": "encounter?institution=<%= institution_id %>",
          "action": "*",
          "delegable": true
        },
        {
          "resource": "role?institution=<%= institution_id %>",
          "action": "*",
          "delegable": true
        }
      ]
    }
  },
  {
    "key": "reader",
    "name": "Institution <%= institution_name %> Reader",
    "policy": {
      "statement": [
        {
          "resource": "institution/<%= institution_id %>",
          "action": [
            "institution:read",
            "institution:readUsers"
          ]
        },
        {
          "resource": "patient?institution=<%= institution_id %>",
          "action": "patient:read"
        },
        {
          "resource": "site?institution=<%= institution_id %>",
          "action": "site:read"
        },
        {
          "resource": "device?institution=<%= institution_id %>",
          "action": "device:read"
        },
        {
          "resource": "testResult?institution=<%= institution_id %>",
          "action": "testResult:query"
        },
        {
          "resource": "encounter?institution=<%= institution_id %>",
          "action": "encounter:read"
        },
        {
          "resource": "testResult?institution=<%= institution_id %>",
          "action": "testResult:medicalDashboard"
        }
      ]
    }
  }
]
